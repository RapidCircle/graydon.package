<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Introduction</title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>



<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<ul>
<li><a href="#introduction">Introduction</a>

<ul>
<li><a href="#example_data">Example data</a></li>
</ul></li>
<li><a href="#create_hierachy_graph">Creating a company hierarchy graph</a></li>
<li><a href="#selecting">Selecting company hierarchies graphs</a>

<ul>
<li><a href="#selecting_single">Selecting a hierarchy by company ID</a></li>
<li><a href="#selecting_multiple">Selecting hierarchies with a column of company IDs</a></li>
<li><a href="#selecting_ego_graphs">Selecting company neighbourhoods with a column of company IDs</a></li>
<li><a href="#selecting_all">Listing all hierarchy graphs</a></li>
</ul></li>
<li><a href="#selecting">Converting company hierarchy graphs to data-frames</a>

<ul>
<li><a href="#selecting_single">Converting a single hierarchy graph</a></li>
<li><a href="#selecting_multiple">Converting a list of hierarchy graphs</a></li>
</ul></li>
<li><a href="#calculate">Calculating properties</a>

<ul>
<li><a href="#summing_values">Summing values</a></li>
<li><a href="#propagate_values">Propagating values</a></li>
<li><a href="#adding_stats">Adding graph statistics</a></li>
<li><a href="#marking">Marking companies</a></li>
<li><a href="#sister_companies">Sister companies</a></li>
<li><a href="#recode_holdings">Recoding holdings</a></li>
</ul></li>
</ul>

<h1>Introduction</h1>

<p>In our database we can find the relations between companies by a parent child relation, but there is a lot of information that can be gained from the total total tree of company relations. This package contains several functions that is useful for extracting this kind of information, and for plotting the total company hierarchy.</p>

<h3><a name="example_data"></a>The example data</h3>

<p>First let&#39;s load the package:</p>

<pre><code class="r">library(graydon.package)
</code></pre>

<p>The package contains a data frame, <em>tbl_company_relations</em> which is an ex(s)ample of how company relations are typically represented in our database (<em>id_company</em>, <em>id_company_parent</em>), with some extra added data about each of the companies. The data frame contains the following columns:</p>

<table><thead>
<tr>
<th align="left">Column.names</th>
</tr>
</thead><tbody>
<tr>
<td align="left">id_company</td>
</tr>
<tr>
<td align="left">id_company_parent</td>
</tr>
<tr>
<td align="left">code_sbi</td>
</tr>
<tr>
<td align="left">size_company</td>
</tr>
<tr>
<td align="left">qty_employees</td>
</tr>
</tbody></table>

<h1><a name="create_hierachy_graph"></a>Creating a company hierarchy graph</h1>

<p>Company relations in our database are represented in parent-child relations, but this doesn&#39;t give you the complete overview of how companies fit together in their complete hierarchy.  <a href="https://en.wikipedia.org/wiki/Graph_(discrete_mathematics">Graphs</a> provide a way of getting those overviews. Let&#39;s load the <a href="http://igraph.org/r/doc/"><em>igraph</em></a> library first:</p>

<pre><code class="r">library(igraph)
</code></pre>

<p>With a simple function call we can create a graph, based on those parent-child relationships expressed in a table. Make sure the child and the parent ID columns are the first and second column in the table respectively.</p>

<pre><code class="r">graph_company_hierarchies &lt;- create_graph_company_hierarchies(tbl_company_relations)
</code></pre>

<p>The resulting graph represents a network of all individual company hierarchies in one big &#39;space&#39; which can be graphically represented like below. You can see this plot is pretty useless in in itself, but this &#39;space&#39; of hierarchies can be used as a &#39;database&#39; to easily retrieve the desired company hierarchies which are usefull for plotting and doing calculations within those.</p>

<p>The <em>plot_graydon_graph</em> function is used to plot graphs using graydon colors, the extra parameters <em>vertex.label</em>, <em>vertex.size</em> and <em>edge.arrow.size</em> are set so they override the defaults.</p>

<pre><code class="r">plot_graydon_graph(graph_company_hierarchies,
                   vertex.label = &quot;&quot;,
                   vertex.size = 4,
                   edge.arrow.size = 0)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-5"/></p>

<h1><a name="selecting"></a>Selecting company hierarchies graphs</h1>

<p>There are a few ways which we can select the distinct company hierarchies so we can make useful calculations or plots about them: you can either select them individually or by bulk.</p>

<h2><a name="selecting_single"></a>Selecting a hierarchy by company ID</h2>

<p>If you have a single company that you want to find out about more you can select it using the function <em>find_company_hierarchy</em>:</p>

<pre><code class="r">id_company_selected &lt;- &quot;931238099&quot;
graph_company_hierarchy &lt;- find_company_hierarchy(graph_company_hierarchies, id_company_selected)
</code></pre>

<p>The resulting graph has the logical attribute <em>is_searched_company</em> set to <em>TRUE</em> of the searched for company. Let&#39;s plot this graph, highlighting the searched for companies:</p>

<pre><code class="r">igraph::V(graph_company_hierarchy)$color &lt;- ifelse(igraph::V(graph_company_hierarchy)$is_searched_company,
                                                   col_graydon[2],
                                                   col_graydon[4])
plot_graydon_graph(graph_company_hierarchy)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-7"/></p>

<h2><a name="selecting_multiple"></a>Selecting hierarchies with a column of company IDs</h2>

<p>A customer&#39;s file contains multiple companies of which we might want to calculate, or show (parts) of their hierarchy. The <em>list_selected_hierarchies</em> function can be used to put the graphs of all these companies in a list. In this example we have a data frame <em>tbl_customers</em> with the column <em>id_company</em>, of which we want to retrieve all the graphs. </p>

<pre><code class="r">list_selected_hierarchies &lt;- select_graph_hierarchies(graph_company_hierarchies, 
                                                      tbl_customers$id_company)
</code></pre>

<p>Note that the <em>tbl_customers</em> data-frame contains 300, while the <em>list_selected_hierarchies</em> contains 249 graphs; this is because there are customers that fall within the same company hierarchy. The companies in the graphs in this list now also contain an extra logical attribute, <em>is_searched_company</em>, which indicates whether the company was in the <em>id_company</em> column. Let&#39;s take a look at one of the graphs that contain multiple customers. The customer &#39;vertices&#39; are colored orange here:</p>

<pre><code class="r">igraph::V(graph_example)$color &lt;- ifelse(igraph::V(graph_example)$is_searched_company,
                                                   col_graydon[2],
                                                   col_graydon[4])
plot_graydon_graph(graph_example, vertex.label = &quot;&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-11"/></p>

<h2><a name="selecting_ego_graphs"></a>Selecting company neighbourhoods</h2>

<p>You can also select parts of company hierarchies by selecting it&#39;s neighbourhood. These kinds of graphs are called <a href="https://en.wikipedia.org/wiki/Neighbourhood_(graph_theory">Neighborhood- or Ego graphs</a>). You can find the neighbourhood of companies with the function <em>select_ego_graphs</em>. In this example we are looking for two ego graphs, where are neighbourhood is defined as being two steps away as a maximum (set by the function argument <em>distance</em>, where it&#39;s default is 1), and we want only the companies (grand)children (as set by the argument <em>only_children</em>, which default value is FALSE). Both requested company ID&#39;s come from the same company hierarchy, but result in two ego graph&#39;s nonetheless. </p>

<pre><code class="r">lst_results &lt;- select_ego_graphs(graph_company_hierarchies, 
                                 id_companies = c(&quot;169072&quot;, &quot;910716048&quot;), 
                                 distance = 2, 
                                 only_children = TRUE)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAABR1BMVEUAAAAAAAMAAB8AADIAADoAAFkAAGYAGQQAJ30ALAYAOpAARp4AZrYgAAAgJzIgRp4gY78qAAA1AAA1GQM1H0w1PgY4AAA4ADI4AFk4JzI4J304Rp44Y784ft46AAA6Ojo6kNtLHwBLNUxLcodOJwBOJ1lORn1Ol79Ol95eAABeAANeGQReLAZeTghfhYdjRgBjRjJjRlljl31jsN5mAABmADpmAGZmOjpmOpBmZrZmkNtmtv9ySzZyhYd3YzJ3Y1l3fll3sN6EGQCEGQOELASEXgiFXzaFckyFhWCFhXSFhYeLflmLl32LsJ6LsL+LsN6QOgCQOmaQZpCQ2/+oLAOobgi2ZgC2Zjq2Zma2//+6pG26v6a6v8HJPgPJbgjbkDrbkGbbtmbb29vb///rTgPrXgTrbgbrbgj/tmb/25D//7b//9v///8j3UxPAAAACXBIWXMAAAsSAAALEgHS3X78AAAK3UlEQVR4nO3dbXcTxx2G8UmANA3Q0jZ9SGKnJJjUfQiFmLakbqFuSxrLttaggHFrglullpH2+7/u7MqNhC3ZEt7dmfnf13WOx4b1QXP2d0bS4mFxOUnmQk+AwgS8aMCLBrxowIsGvGjAiwa8aMCLBrxowIsGvGjAiwa8aMCLBrxowIsGvGjAiwa8aMCLBrxowIsGvGjAiwa8aMCLBrxowIsGvGjAiwa8aMCLBrxowIsGvGjAiwa8aMCLBrxowIsGvGjAiwa8aMCLBrxowIsGvGjAiwa8aMCLBrxowIsGvGjAiwa8aMCLBrxowIsGvGjAiwa8aMCLBrxowIsGvGjAiwa8aMCLBrxowIuWOnzW8mWhZ5FgacMX6D7/KfRMkitl+KH6MOjnLEX4wfbFjh8/XvPgG9ey9tKFZT+82RkeGB/caui5RluK8Pud/r3uoXvbw2+9t5A9WN56f80P73bLA6PhcHXwuBt6srGWIvxOZ/Bot9X+xMPf+Wwhu73cvrlSDLfKA6Nhv5M/2w092VhLEf7lh+6tIfzG4uZCtnnVXVophlvlgdEA/CmlCJ/n/c9bmYdvLznnFv0T/gdZObT8gfLocAD+lFKEH2z7BZ+VT/WZX/HtpUsrw2HdHyiPDof+XXc99FyjLUV439iF3Hhc080c8KIBLxrwogEvGvCiJQo/WR732QNetFThJ8njPkfAi5Ys/El53OcpXfjj8rjPVcLwbL06TynDs9nyHKUNz/bq1y51eHrNbMDvhZ5AegEvmg145OcOeNGAFw140YzAIz9vwIsGvGjAi2YFHvk5A1404EUDXjQz8MjPF/CiAS8a8KLZgUd+roAXDXjRgBfNEDzy8wS8aMCLBrxoluCRnyPgRQNeNOBFMwWP/OwBLxrwogEvmi145GcOeNGAFw140YzBIz9rwIsGvGjW4JGfMeBFA1404EUzB4/8bAEvGvCiAS+aPXjkZwp40YAXDXjRDMIjP0vAiwa8aMCLZhEe+RkCXjTgRQNeNJPwyJ8d8KIBLxrwotmER/7MgBcNeNGAF80oPPJnBbxowIsGvGhW4ZE/I+BFA1404EUzC4/86QEvGvCiAS+aXXjkTw140YAXzTA88qcFvGjAiwa8aJbhkT8l4EUDXjTgRTMNj/z0gBcNeNGAF802PPJTA1404EUDXjTj8MhPC3jRgBcNeNGswyM/JeBFA1404EUzD4/85IAXDXjRgBfNPjzyEwNeNOBFA140AXjkJwW8aMCLBrxoCvDITwh40YAXTQIe+ZMBLxrwogEvmgY88icCXjTgRQNeNBF45I8HvGjAiwa8aCrwyB8LeNGAFw140WTgkX814EUDXjTgRdOBR/6VgBcNeNGAF00IHvnxgBcNeNGAF00JHvmxgBdNC94Xeg6xpAS/B/woJfgc91HAiyYFnwP/bcCLpgWP/Lepwfdavl7oaUSQFnyB7vOfQs8keErwrfW/f93rHfz1U//x5o18sO1W86fOXeyUX4klBN/6xn3n697Brx72es8fHvz6z4erg8fdPPfDTmfwaDf09BpOB94/yR/4Ff/Nj9ynva8eHvztyZ86+TPPfVgs9v69buj5NZwMfPHiXsA//3Hvqyf//aF748nzGwV8uerznU7o+TWdHnyx3v2Xv+kN4Q+v+4NP5V7iZeDLd/MF/MEv3Xf9m7s3nhRfXc/7v/fP9i+Kd3ihZ9hwUvDHU76oE4Gf6C4tD7xowIsGvGjAiwZ8keAPa0Xgp1zO7f2/0NNrPm34o523wBtugvzwiV5UHvjhfiw5fBn4k/Kjt/RH5FL4OvB7rWnur3yXCr4KfMHZGqM/bdedBL4I/BHl7JstzeMrwI+/bZ9ne7VpfAH4c12umcUXgD83nkl84Jv7M6JKAH4vr+inMKbw7cNXa2UG3zx8DUwm7K3D10SU/sI3Dl+nTtr4tuFrh0kX3zR8MyZp4luGb5AjPXzD8E1LpIVvFz4IQjr4ZuHDnf808K3CBz718eMbhY/hrMeNbxM+mhMeL75J+LjOdZz4FuEjPM3x2RuEj+0UHxXZwrcHH9PZPV5E+ObgYzmxU4sE3xp8DOf07CLANwYf+nTOUWB8W/AJuZfNjp8V/xAkq/ChTcGn5l42C36B7qvyPvuW4JN0L5uMX95Gf7B98UYray8teviNa9n6R/73+nfdW7vlMLrn/rwPaQg+Xfeyk/jlDfX3O1++v7b102XvvvXeQraxuP642//cHy2H0T335304O/CJu5e9iv/vP/bvdXdutG+ubHzP+RV/57OF7C8LW+92X/7Br/NyKL/l6J7782UG3oJ72Qj/5YfuSv6Pq+7Syv1r2Z2VjcXNhWzzqrvcyv9T3GC/GMpveZ0FbwbejHvZEH+/+C80WtnWB9n9xez2L5acc4sPlrM7t/wC3++UQ/ktw3vuz5kReFvuZXt7//yBu9JqL11aybZ+4i77F/mjFZ99ede90+0XQ7niy3vuz5sNeIPuZXt75WXc8aq4qDMBb9XdX8BPcq9E3gK8XXfgT8uwO/CnZNkd+OmZdgd+arbdgZ+Wcfcp8lzOmXcHfmL23SfKV/JD+ZThFdyBP5mE+wT5anbhpAsv4n5CvqLdV8nCy7gXO+7G2KvadZcqvJB7zmbLUVruOdurj5Jzr74k4XE/fynC415BCcLjXkXpweNeScnB415NqcHjXlGJweNeVWnB415ZScHjXl0pweNeYQnB415l6cDjXmnJwONebanA415xicDjXnVpwONeeUnA4159KcDjXkMJwONeR/HD415L0cPjXk+xw+NeU5HD415XccPjXltRw+NeXzHD415jEcPjXmfxwuNea9HC415vscLjXnORwuNed3HC4157UcLjXn8xwuPeQBHC495E8cHj3kjRwePeTLHB495QkcHj3lRxwePeWFHB495cMcHj3mARwePeZPHA495o0cDj3myxwOPecJHA4950ccDj3nhRwOPefDHA4x6gCOBxD1F4eNyDFBwe9zCFhsc9UIHhcQ9VWHjcgxUUHvdwhYTHPWAB4XEPWTh43IMWDB73sIWCxz1wTcEf+//PcQ9dM/AFus9/Gv4a9+A1AT9UH1bS4x6+BuBbWfuTtey3zl1Ybi9dWG7l/3rczfPB9qr/cKv1Pz5Nqn74Vrbh3l7zi93zP1j2wxfunW7e/10nz3c6g0e7tU+AJlU7fGtI7seNRT9sfj/L1v2KP/x5udj797p1T4Am1hx8Odx3l4fwL67nz3aLNV/349Pk6oYv39eV5hvXsuz2cvvmStb+2MOvFuhPeYkPVWPwWz9b8fiuWPEFfP+uu5K/cO4iSz5MNcOPXciN16r3UensgBcNeNGAFw140YAXrZHLOdzjC3jRGvkrW9zjC3jRmvixLO4R1shGDNzjK8jWKwpfmM2WFLxA26spdKFvjECBAl404EUDXjTgRQNeNOBFA1404EUDXjTgRQNeNOBFA1404EUDXjTgRQNeNOBFA1404EUDXjTgRQNeNOBFA1404EUDXjTgRQNeNOBFA1404EUDXjTgRQNeNOBFA1404EUDXjTgRQNeNOBFA1404EUDXjTgRQNeNOBFA1404EUDXjTgRQNeNOBFA1404EUDXjTgRQNeNOBFA1404EUDXjTgRQNeNOBFA1404EUDXjTgRQNeNOBFA1404EUDXjTgRQNeNOBFA1404EUDXjTgRQNeNOBFA1404EUDXrT/AUU5jnA6P97HAAAAAElFTkSuQmCC" alt="plot of chunk unnamed-chunk-13"/>
<img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-14"/></p>

<h2><a name="selecting_all"></a>Listing all hierarchy graphs</h2>

<p>For whatever reason, you might want to creating a list of all of the seperate company hierarchies out of the complete company hierarchy &#39;space&#39;. This will take some time, so take some coffee&hellip;.    </p>

<pre><code class="r">list_all_graphs &lt;- list_company_hierarchy_graphs(graph_company_hierarchies)
</code></pre>

<h1><a name="convert_graph"></a>Converting company hierarchy graphs to data-frames</h1>

<p>Having graphs is nice for creating beautiful plots and useful calculations, but for the data to be useful for further processing, getting data from the graph into a data-frame format is handy.</p>

<h2><a name="convert_single_graph"></a>Converting a single hierarchy graph</h2>

<p>To turn a graph into a data-frame youy can use the function <em>hierarchy_as_data_frame</em>. We created the graph <em>graph_company_hierarchy</em> by searching hierarchies by company IDs and set the colors to them being in the searched-for companies, this is reflected by the <em>graph_company_hierarchy</em> and <em>color</em> columns respectively.</p>

<pre><code class="r">df_single_hierarchy &lt;- hierarchy_as_data_frame(graph_company_hierarchy)
</code></pre>

<table><thead>
<tr>
<th align="left">name</th>
<th align="right">id_company_parent</th>
<th align="left">code_sbi</th>
<th align="right">size_company</th>
<th align="right">qty_employees</th>
<th align="left">is_searched_company</th>
<th align="left">color</th>
</tr>
</thead><tbody>
<tr>
<td align="left">1003667</td>
<td align="right">931238099</td>
<td align="left">7022</td>
<td align="right">2</td>
<td align="right">15</td>
<td align="left">FALSE</td>
<td align="left">#8BB0DE</td>
</tr>
<tr>
<td align="left">931238099</td>
<td align="right">933898487</td>
<td align="left">6420</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="left">TRUE</td>
<td align="left">#EB6E08</td>
</tr>
<tr>
<td align="left">933898487</td>
<td align="right">911277358</td>
<td align="left">7022</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="left">FALSE</td>
<td align="left">#8BB0DE</td>
</tr>
<tr>
<td align="left">936298138</td>
<td align="right">931238099</td>
<td align="left">7311</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="left">FALSE</td>
<td align="left">#8BB0DE</td>
</tr>
<tr>
<td align="left">911277358</td>
<td align="right">NA</td>
<td align="left">6420</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="left">FALSE</td>
<td align="left">#8BB0DE</td>
</tr>
</tbody></table>

<h2><a name="convert_list_graphs"></a>Converting a list of hierarchy graphs</h2>

<p>A list of graphs can also be converted into a data-frame using <em>hierarchy_list_as_data_frame</em>:</p>

<pre><code class="r">df_selected_hierarchies &lt;- hierarchy_list_as_data_frame(list_selected_hierarchies)
</code></pre>

<h1><a name="calculate"></a>Calculating properties</h1>

<h2><a name="summing_values"></a>Summing values</h2>

<p>Totalling values from across the network can sometimes come in handy for further calculations. You can use the function <em>total_hierarchy_value</em> in combination with aggregation functions like <em>sum</em>, <em>mean</em>, <em>min</em> or <em>median</em> for this</p>

<pre><code class="r">graph_company_hierarchy &lt;- total_hierarchy_value(graph_company_hierarchy, 
                                                 name_attribute = &quot;qty_employees&quot;, name_total = &quot;qty_employees_sum&quot;, 
                                                 FUN = sum, na.rm = TRUE)
</code></pre>

<p>The result can be found can be shown in a graph, where we can see the original values and the totalled values.</p>

<pre><code class="r">igraph::V(graph_company_hierarchy)$label &lt;- paste0(&quot;# &quot;,
                                                   igraph::V(graph_company_hierarchy)$qty_employees,
                                                   &quot; -&gt; Sum # &quot;,
                                                   igraph::V(graph_company_hierarchy)$qty_employees_sum)

plot_graydon_graph(graph_company_hierarchy)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-20"/></p>

<h2><a name="propage_values"></a>Propagating values</h2>

<p>It might come in handy to cumulate values in the hierarchy bottom up; this is where the <em>aggregate_company_hierarchy_value</em> function comes in handy. In this example the companies will get a new attribute <em>qty_employees_cum</em> which will contain the sum of all the <em>qty_employees</em> of the companies that below the company within the hierarchy.</p>

<pre><code class="r">graph_company_hierarchy &lt;- 
  aggregate_hierarchy_value(graph = graph_company_hierarchy, 
                            name_attribute = &quot;qty_employees&quot;,
                            name_aggregate = &quot;qty_employees_cum&quot;,
                            FUN = sum, 
                            na.rm = TRUE)
</code></pre>

<p>The result can be found can be shown in a graph, where we can see the original values and the rolled up values.</p>

<pre><code class="r">igraph::V(graph_company_hierarchy)$label &lt;- paste0(&quot;# &quot;,
                                                   igraph::V(graph_company_hierarchy)$qty_employees,
                                                   &quot; -&gt; Cum # &quot;,
                                                   igraph::V(graph_company_hierarchy)$qty_employees_cum)

plot_graydon_graph(graph_company_hierarchy)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-22"/></p>

<h2><a name="adding_stats"></a>Adding graph statistics</h2>

<p>Some overall statistics about the hierarchy can be added to the individual companies by using the <em>add_company_hierarchy_stats</em> function. This function will add the following attributes</p>

<ul>
<li><em>is_tree</em> - A logical indicating whether the company hierarchy is a tree (which should always be the case).</li>
<li><em>qty_comapny_hierarchy</em> - The the number of companies in the hierarchy.</li>
<li><em>id_company_top</em> - The company ID of the highest company in the hierachy (ultimate mother).</li>
<li><em>distance_to_top</em> - The number of companies between the current company and the ultimate mother company</li>
<li><em>qty_child_companies</em> - The number of child companies.</li>
<li><em>qty_sister_companies</em> - The number of sibling companies.</li>
</ul>

<pre><code class="r">graph_company_hierarchy &lt;- add_company_hierarchy_stats(graph_company_hierarchy)
</code></pre>

<p>Let&#39;s look at the statistics:</p>

<pre><code class="r">df_single_hierarchy &lt;- hierarchy_as_data_frame(graph_company_hierarchy)
</code></pre>

<table><thead>
<tr>
<th align="left">name</th>
<th align="right">id_company_parent</th>
<th align="left">code_sbi</th>
<th align="right">size_company</th>
<th align="right">qty_employees</th>
<th align="left">is_searched_company</th>
<th align="right">qty_employees_sum</th>
<th align="right">qty_employees_cum</th>
<th align="left">is_tree</th>
<th align="right">qty_hierarchy_companies</th>
<th align="left">id_company_top</th>
<th align="right">distance_to_top</th>
<th align="right">qty_child_companies</th>
<th align="right">qty_sister_companies</th>
</tr>
</thead><tbody>
<tr>
<td align="left">1003667</td>
<td align="right">931238099</td>
<td align="left">7022</td>
<td align="right">2</td>
<td align="right">15</td>
<td align="left">FALSE</td>
<td align="right">18</td>
<td align="right">15</td>
<td align="left">TRUE</td>
<td align="right">5</td>
<td align="left">911277358</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">2</td>
</tr>
<tr>
<td align="left">931238099</td>
<td align="right">933898487</td>
<td align="left">6420</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="left">TRUE</td>
<td align="right">18</td>
<td align="right">17</td>
<td align="left">TRUE</td>
<td align="right">5</td>
<td align="left">911277358</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">1</td>
</tr>
<tr>
<td align="left">933898487</td>
<td align="right">911277358</td>
<td align="left">7022</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="left">FALSE</td>
<td align="right">18</td>
<td align="right">17</td>
<td align="left">TRUE</td>
<td align="right">5</td>
<td align="left">911277358</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr>
<td align="left">936298138</td>
<td align="right">931238099</td>
<td align="left">7311</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="left">FALSE</td>
<td align="right">18</td>
<td align="right">2</td>
<td align="left">TRUE</td>
<td align="right">5</td>
<td align="left">911277358</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">2</td>
</tr>
<tr>
<td align="left">911277358</td>
<td align="right">NA</td>
<td align="left">6420</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="left">FALSE</td>
<td align="right">18</td>
<td align="right">18</td>
<td align="left">TRUE</td>
<td align="right">5</td>
<td align="left">911277358</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
</tbody></table>

<h2><a name="marking"></a>Marking companies</h2>

<p>You can mark companies within a graphthat meet certain categorical  criteria with the function <em>mark_companies_logical</em>. This can be useful for derivations or coloring graphs. As a somewhat travial  example, let&#39;s mark the companies that have SBI codes (from <em>code_sbi</em>) that are a associated with holdings (that are in the vector <em>vec_sbi_holdings</em>). The new company attribute name will be <em>is_holding</em>.</p>

<pre><code class="r">vec_sbi_holdings &lt;- c(&quot;64&quot;, &quot;642&quot;, &quot;6420&quot;)

graph_company_hierarchy &lt;- mark_companies_logical(graph_company_hierarchy,
                                                  name_logical = &quot;is_holding&quot;,
                                                  name_filter = &quot;code_sbi&quot;,
                                                  set_criteria = vec_sbi_holdings)
</code></pre>

<h2><a name="sister_companies"></a>Sister companies</h2>

<p>You can get the siblings IDs of a company using the function <em>get_sibling_ids</em>, which in turn can be used to mark companies and plot them.</p>

<pre><code class="r">id_siblings &lt;- get_sibling_ids(graph_company_hierarchy, &quot;1003667&quot;)

graph_company_hierarchy &lt;- mark_companies_logical(graph_company_hierarchy,
                                                  name_logical = &quot;is_sibling&quot;, 
                                                  name_filter = &quot;id_company&quot;,
                                                  set_criteria = id_siblings
                                                  )

igraph::V(graph_company_hierarchy)$label &lt;- igraph::V(graph_company_hierarchy)$name
V(graph_company_hierarchy)$color &lt;- ifelse(V(graph_company_hierarchy)$is_sibling,
                                                   col_graydon[2],
                                                   col_graydon[4])

plot_graydon_graph(graph_company_hierarchy)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-27"/></p>

<p>Remember the table of customers? If we want to get all siblings of those companies we can use the function <em>get_siblings_df</em>.</p>

<pre><code class="r">tbl_siblings &lt;- get_siblings_df(graph_company_hierarchies, tbl_customers$id_company)
</code></pre>

<p>Below you can see a sample of the resulting data-frame, where you can see the company with it&#39;s siblings and the <em>qty_siblings</em> indicating the total number of siblings the company of <em>id_company</em> has.</p>

<table><thead>
<tr>
<th align="left">id_company</th>
<th align="left">id_sibling</th>
<th align="right">qty_siblings</th>
</tr>
</thead><tbody>
<tr>
<td align="left">896363228</td>
<td align="left">362528</td>
<td align="right">4</td>
</tr>
<tr>
<td align="left">896363228</td>
<td align="left">602380</td>
<td align="right">4</td>
</tr>
<tr>
<td align="left">896363228</td>
<td align="left">628746</td>
<td align="right">4</td>
</tr>
<tr>
<td align="left">896363228</td>
<td align="left">896361535</td>
<td align="right">4</td>
</tr>
<tr>
<td align="left">906639670</td>
<td align="left">44910</td>
<td align="right">36</td>
</tr>
<tr>
<td align="left">906639670</td>
<td align="left">217844</td>
<td align="right">36</td>
</tr>
</tbody></table>

<h2><a name="recode_holdings"></a>Recoding holdings</h2>

<p>When dealing with customers you&#39;ll ofen encounter them having economic activity codes that mark them as financial holdings. This is often the case because this is the company you send the bills too. But this is not really informative when analysing the type of companies you have as customers. In this case you might want to recode them to better reflect what kind of business they are really in.</p>

<p>Here you see an example of a company hierarchy with some holdings, which are colored orange here:</p>

<pre><code class="r">vec_sbi_holdings &lt;- c(&quot;64&quot;, &quot;642&quot;, &quot;6420&quot;)

graph_company_hierarchy &lt;- mark_companies_logical(graph_company_hierarchy,
                                                  name_logical = &quot;is_holding&quot;,
                                                  name_filter = &quot;code_sbi&quot;,
                                                  set_criteria = vec_sbi_holdings)

igraph::V(graph_company_hierarchy)$label &lt;- igraph::V(graph_company_hierarchy)$code_sbi
V(graph_company_hierarchy)$color &lt;- ifelse(V(graph_company_hierarchy)$is_holding,
                                                   col_graydon[2],
                                                   col_graydon[4])

plot_graydon_graph(graph_company_hierarchy)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-30"/></p>

<pre><code class="r">vec_sbi_holdings &lt;- c(&quot;64&quot;, &quot;642&quot;, &quot;6420&quot;)
library(&quot;png&quot;)

img_holding &lt;- readPNG(&quot;~/R scripts/hierarchy_changes/money-svg-hand-icon-png-3.png&quot;)
img_regular &lt;- readPNG(&quot;~/R scripts/hierarchy_changes/vector-apartments-business-building-6.png&quot;)

graph_company_hierarchy &lt;- mark_companies_logical(graph_company_hierarchy,
                                                  name_logical = &quot;is_holding&quot;,
                                                  name_filter = &quot;code_sbi&quot;,
                                                  set_criteria = vec_sbi_holdings)

V(graph_company_hierarchy)$raster &lt;- list(img_regular, img_holding)[V(graph_company_hierarchy)$is_holding+1]

plot_graydon_graph(graph_company_hierarchy, 
                   vertex.shape=&quot;raster&quot;, 
                   vertex.label=NA,
                   vertex.size=24, 
                   vertex.size2=24, 
                   edge.width=2)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-31"/></p>

<p>You can count the number of financial holdings in a company hierarchy like this:</p>

<pre><code class="r">count_companies_by_set(graph = graph_company_hierarchy,
                       name_filter = &quot;code_sbi&quot;,
                       set_criteria = vec_sbi_holdings)
#&gt; [1] 2
</code></pre>

<p>You can use the function <em>recode_holding_codes</em> to recode the holdings so they reflect the economic activity codes of the majority of the children:</p>

<pre><code class="r">graph_company_hierarchy &lt;- recode_holding_codes(graph_company_hierarchy, 
                                                name_activity_code = &quot;code_sbi&quot;, 
                                                vec_holding_codes = c(&quot;64&quot;, &quot;642&quot;, &quot;6420&quot;))
</code></pre>

<p>This would result in this recoded company hierarchy:
<img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-34"/></p>

</body>

</html>
