<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Introduction</title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>



<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<ul>
<li><a href="#introduction">Introduction</a>

<ul>
<li><a href="#example_data">Example data</a></li>
</ul></li>
<li><a href="#create_hierachy_graph">Creating a company hierarchy graph</a></li>
<li><a href="#selecting">Selecting company hierarchies graphs</a>

<ul>
<li><a href="#selecting_single">Selecting a hierarchy by company ID</a></li>
<li><a href="#selecting_multiple">Selecting hierarchies with a column of company IDs</a></li>
<li><a href="#selecting_all">Listing all hierarchy graphs</a></li>
</ul></li>
<li><a href="#selecting">Converting company hierarchy graphs to data-frames</a>

<ul>
<li><a href="#selecting_single">Converting a single hierarchy graph</a></li>
<li><a href="#selecting_multiple">Converting a list of hierarchy graphs</a></li>
</ul></li>
<li><a href="#calculate">Calculating properties</a>

<ul>
<li><a href="#propagate_values">Propagating values</a></li>
<li><a href="#adding_stats">Adding graph statistics</a></li>
<li><a href="#marking">Marking companies</a></li>
<li><a href="#sister_companies">Sister companies</a></li>
<li><a href="#recode_holdings">Recoding holdings</a></li>
</ul></li>
</ul>

<h1>Introduction</h1>

<p>In our database we can find the relations between companies by a parent child relation, but there is a lot of information that can be gained from the total total tree of company relations. This package contains several functions that is useful for extracting this kind of information, and for plotting the total company hierarchy.</p>

<h3><a name="example_data"></a>The example data</h3>

<p>First let&#39;s load the package:</p>

<pre><code class="r">library(graydon.package)
</code></pre>

<p>The package contains a data frame, <em>tbl_company_relations</em> which is an ex(s)ample of how company relations are typically represented in our database (<em>id_company</em>, <em>id_company_parent</em>), with some extra added data about each of the companies. The data frame contains the following columns:</p>

<table><thead>
<tr>
<th align="left">Column.names</th>
</tr>
</thead><tbody>
<tr>
<td align="left">id_company</td>
</tr>
<tr>
<td align="left">id_company_parent</td>
</tr>
<tr>
<td align="left">code_sbi</td>
</tr>
<tr>
<td align="left">size_company</td>
</tr>
<tr>
<td align="left">qty_employees</td>
</tr>
</tbody></table>

<h1><a name="create_hierachy_graph"></a>Creating a company hierarchy graph</h1>

<p>Company relations in our database are represented in parent-child relations, but this doesn&#39;t give you the complete overview of how companies fit together in their complete hierarchy.  <a href="https://en.wikipedia.org/wiki/Graph_(discrete_mathematics">Graphs</a> provide a way of getting those overviews. Let&#39;s load the <a href="http://igraph.org/r/doc/"><em>igraph</em></a> library first:</p>

<pre><code class="r">library(igraph)
</code></pre>

<p>With a simple function call we can create a graph, based on those parent-child relationships expressed in a table. Make sure the child and the parent ID columns are the first and second column in the table respectively.</p>

<pre><code class="r">graph_company_hierarchies &lt;- create_graph_company_hierarchies(tbl_company_relations)
</code></pre>

<p>The resulting graph represents a network of all individual company hierarchies in one big &#39;space&#39; which can be graphically represented like below. You can see this plot is pretty useless in in itself, but this &#39;space&#39; of hierarchies can be used as a &#39;database&#39; to easily retrieve the desired company hierarchies which are usefull for plotting and doing calculations within those.</p>

<p>The <em>plot_graydon_graph</em> function is used to plot graphs using graydon colors, the extra parameters <em>vertex.label</em>, <em>vertex.size</em> and <em>edge.arrow.size</em> are set so they override the defaults.</p>

<pre><code class="r">plot_graydon_graph(graph_company_hierarchies,
                   vertex.label = &quot;&quot;,
                   vertex.size = 4,
                   edge.arrow.size = 0)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-5"/></p>

<h1><a name="selecting"></a>Selecting company hierarchies graphs</h1>

<p>There are a few ways which we can select the distinct company hierarchies so we can make useful calculations or plots about them: you can either select them individually or by bulk.</p>

<h2><a name="selecting_single"></a>Selecting a hierarchy by company ID</h2>

<p>If you have a single company that you want to find out about more you can select it using the function <em>find_company_hierarchy</em>:</p>

<pre><code class="r">id_company_selected &lt;- &quot;931238099&quot;
graph_company_hierarchy &lt;- find_company_hierarchy(graph_company_hierarchies, id_company_selected)
</code></pre>

<p>The resulting graph has the logical attribute <em>is_searched_company</em> set to <em>TRUE</em> of the searched for company. Let&#39;s plot this graph, highlighting the searched for companies:</p>

<pre><code class="r">igraph::V(graph_company_hierarchy)$color &lt;- ifelse(igraph::V(graph_company_hierarchy)$is_searched_company,
                                                   col_graydon[2],
                                                   col_graydon[4])
plot_graydon_graph(graph_company_hierarchy)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAABUFBMVEUAAAAAAAMAAB8AACwAADIAADoAAE0AAFkAAGYAGQQAH0wAJ30ALAYAOpAARp4AZrYfNWAgAAAgJzIgRp4gY781H0w1LAY4AAA4ADI4AFk4J304Rp44Y784ft46AAA6Ojo6ZrY6kNtLHwBLNUxLcodOJwBOJ1lORn1Ol95eGQReTghfNR9fhYdjRgBjRjJjRlljsN5mAABmADpmAGZmOjpmOpBmZrZmkNtmtv9pK01ppMFySzZyhYd3YzJ3Y1l3fll3sN6EGQCEGQOELASEXgiFTCyFckyFhWCFhXSFhYeFv8GLflmLl32LsJ6LsL+LsN6QOgCQOmaQZpCQ2/+ga02oLACoLAOobgi2ZgC2Zjq2Zma225C2/9u2//+6v6a6v8HJPgPJbgjbkDrbkGbbtmbb29vb///rTgPrXgTrbgbrbgj/tmb/25D//7b//9v///9MqSElAAAACXBIWXMAAAsSAAALEgHS3X78AAAMDElEQVR4nO3dbXcTxx2H4S2FQh8CSUOaltQ0JJCoKRDTBOySmroNJVaNvAa1aaFVBZgqwbak7/+us7syCFs2srQz89/93fc5DBbWwbtzeYRkL55kSJIlsQ+A4gS8aMCLBrxowIsGvGjAiwa8aMCLBrxowIsGvGjAiwa8aMCLBrxowIsGvGjAiwa8aMCLBrxowIsGvGjAiwa8aMCLBrxowIsGvGjAiwa8aMCLBrxowIsGvGjAiwa8aMCLBrxowIsGvGjAiwa8aMCLBrxowIsGvGjAiwa8aMCLBrxowIsGvGjAiwa8aMCLBrxowIsGvGjAiwa8aMCLBrxowIsGvGjAiwa8aMCLBrxowIsWCj5tutJAH4zeXBj4DN3lfgvy4WpY6QsnBHyhXgT9LHlYOD7hB5un2m78eDVNNz5dTTeuJAvptSQ51f5XNuTv7d9IznQGm8myx8OoeIOHf2zmU5cPax/lc7q5XAz5TM701/qE32r3b/Z2kp+upuvZcL2x8cmi+xz4uJedTW+r7Yb+LXe/nWX3lsfjqHQ7yU/c/C24lZMPdxprbtZ+77DzIZ/Jmf5en/CP2oMHnWa22PMVn6atC25cX2hm1u79ux8Od790i/35kvsE8Xgc1W7NTd2dRvr5Yj6k6f23hzu/cbOWD6OZnCGf8LsX3eP4OPz1Rv5Ws/g0fZacGw7/5z493P3OeTyMapfP3xj8SnK2+ezS8HEnH2Ze8J6f3PVvNdNX8NcWHP76efckZefS6PHAfb5utbfa2SnQxPbBZ/9eXn227GYvH4bZTM6U3yd3bsG/gl9JkpON1q/co9U3X3Syf7zcOndP7t7qseIPr5i/1vvJ+WJYT5Kz6Tc3iqlzwxezrhjPL+fGXsiNx2u6aZs4gWVMH/Cm8zd/wJsOeNGAFw140SoL7+9ZqUbAq1bVl3MTjxz36asXfLfb9f1ha5OvheP/QowDR+6OuzvK+wevftWF33/oxWHjPm2TFk4JRbv0Cvhpm7hw5i7exZbIT5uXaxYjXl7dzfADffgq163cxZbTBP2bKiaokpdXHx30R+dpeuLDQ39kvubGAjz0h+dtYmzAQ39I/mbFCrzPc6xwCvAs+oN5nBFD8NDvz+d0mIKH/rW8zoUxeOjH0oKHfi+/02AQHvo8z3NgEh56/69ujcJDLwsvTu/93A3DK9P7P3HT8LJfxw1w2sbhRRc98ENJ+hBnbB9ejz7I6VYBXow+zLlWA16KHvjXU6EPdJrVgRehD3WOVYJXoA92gtWCrz898IdWa/pw51Y9+Dp/HTfgmVURvraLPuRpVRK+rvTAT1EN6YOeUWXh60cf9nQqDD+ZvrIb3AX+NK40/EH6Cm9wB/zxGqev8gZ3of/dqjx8Rp9vYTfYPNFIN66cbKSjXdpOZH9W7NR0qXhr9l3avBf8+UoN4IfDv9/u3+xtXc63ZXu1QVvrvV6xo13/y6W9ve2sbnAX/nlqLeAftf/7h04zvf+ue4h3w59+3bqwmm/XVOxo9/jfS3t72826S5vvgJ+pbIO7vzVXkrNpti1bev+dYjh9Nd/famd5d2lY7HTFgn9ZLeDzDe7yHUzzYbQlY+uD9Kv28PF/NpMkWS72tpt5lza/xfiCRC3g8w3u8h3Z8iFf8RtXTi+m94od7fZW/Oy7tHktyheiagE/rPYeKMDPUYXh43zlGfjYRfqOA/CRi/WdJuAjB/x8VRU+2reW6wJf0X3O4l1SAHzMIl5KUhv4Sm5wB3wJTd7gLvZRHVnMo6sP/KEb3MU+rkOLemQ1gj9igzuT+HEPqk7wEy+9MusOfJlNuNjSqnzkY6oZ/KTLq7smN7iLfUC1g59QPsfG6KMfjQL8qOhzPV70gxGCt7To4x+JErwdegOHoQVvhN7CMajBm6CPfwSK8PHpLbhLwkemN+EuCh9z9m24y8LHW/TAxy4OvRF3Zfgo9FbcteHD05txV4cPTQ+8oQLS23EHPiuUhyF34PPCLHpL7sCPCkEPvMm805tyB34sv/S23IF/LY/0xtyB35c3H+CN52nRW3MH/mA+6M25Az+p0untuQM/uZLpga9OZdIbdAf+8Eqjt+gO/FGVI2bSHfgjK2XRA1/F5qe36Q78G5uT3qg78FM0D71Vd+CnanZ64CvejPRm3YGfulkM7boDP33HX/SG3YE/TselB742TU3fHdp2B/64TUnv7mbaHfjjNxW90R+n+SrgZ2gKU6s/SPVlwM/UG02tuwM/Y5NYt7Mfo7s9erdtduBnbz9thu4qfnC2eXfg5yjTHWyeamfD5eb2i6+fbr/4c/LZ9tpHP7zt/ixZ3huKu7RjH+9rAT9P3e5Wu3+zt9Ve+/rpd8mPn25/e/fFX/755O7aw97O8mA0jO7ihtiHOx7w8/XX24MHnWHz+19s5yvejb914/dvD58v5dzDx51HbXeXfIh9sOMBP1+7F5MfdZpPkp/twX97d3vb3WzmG9bn8O6tM8UQ+2DHA37e+re6v8se4Av4f3y2nT/eX83N8yG7y3A02An4+Rpsnuk0v0v2VvyTJPnB3fzmvWzF928kl/K7FIOlgJ+//GXc/qzvcgn83E10Ny8P/NwBLxrwogEvGvCiAa8aL+dEA161CfLW3YEvI+BVOyBv3h34cmpWzR34kmqO0Tcr4A58ab12saX9gC+vscur7Qd8ydm/sLoI+JIDXjT7/4emCPiyA160iix54MvO/P+TLQK+5Mz/x/hRwJdcNdiB9xDwogEvGvCqVUIe+PIDXjTgRQNetSrIA+8h4EUDXjTgVauAPPA+Al404EUDXjX78sB7CXjRgBcNeNXMywPvJ+BFA1404FWzLg+8p4AXDXjRgBcNeNWMywPvK+BFA1404FWzLQ+8t4AXDXjRgFfNtDzw/gJeNOBFA141y/LAewx40YAXDXjVDMsD7zPgRQNeNOBVsysPvNeAFw140YBXzaw88H4DXjTgRQNeNavywHsOeNGAFw141YzKA+874EUDXjTgRQNeNZvywHsPeNGAFw141UzKA+8/4EUDXjTgVbMoD3yAgBcNeNGAV82gPPAhAl404EUDXjV78sAHCXjRgBcNeNXMyQMfJuBFA1404FWzJg98oIAXDXjRgFfNmDzwoQJeNOBFA1404FWzJQ98sIAXDXjRgFfNlDzw4QJeNOBFA141S/LABwx40YAXDXjVDMkDHzLgRQNeNOBVsyMPfNCAFw140YBXzYw88GEDXjTgRQNeNSvywAcOeNGAFw141YzIAx864EUDXjTgVbMhD3zwgBcNeNGAFw141UzIAx8+4EUDXjTgVbMgD3yEgBcNeNGAV82APPAxAl404EUDXrX48sBHCXjRgBcNeNWiywMfJ+BFA1404FWLLQ98pIAXDXjRgFctsjzwsQJeNOBFA161uPLARwt40dKmK4310YGPVIbucr/F+fjAR6lQL4pDD3zQBpun2m440UjTjSsL7leSDSeyP0uW3bsf9vbukt30GfBB22r3b/a2Lm98utr6pcO/3tj4ZPFOo/Veb2fZoe8kb/XcXbK3sptejwT4oD1qDx50mun9d9P1n7vFnqatC6uZ/tXnS+4zYlho7344LG76DPig7V5MznSaK8nZdOV8+vlitubT++8kp6+6d5wrHuqHz9xbxU2fAR+4/q1m/gC/spChX8tWfdr6IP2qPXzcyeHzB4Wt/KbPgA/aYNMt+PXErfjW+9myT5KTjY0rpxfTey9X/E7Ciq9lYy/kxgv9mg740AEvGvCiAS8a8KIBr9pE+eDfqAE+eMCrNkE+/HdmgQ8f8KodkI9wKQbwMWpGdwc+Tlx6JRsXW8rG5dUUIeBFA1404EUDXjTgRQNeNOBFA1404EUDXjTgRQNeNOBFA1404EUDXjTgRQNeNOBFA1404EUDXjTgRQNeNOBFA1404EUDXjTgRQNeNOBFA1404EUDXjTgRQNeNOBFA1404EUDXjTgRQNeNOBFA1404EUDXjTgRQNeNOBFA1404EUDXjTgRQNeNOBFA1404EUDXjTgRQNeNOBFA1404EUDXjTgRQNeNOBFA1404EUDXjTgRQNeNOBFA1404EUDXjTgRQNeNOBFA1404EUDXjTgRQNeNOBFA1404EX7PxTmsjfyeoB5AAAAAElFTkSuQmCC" alt="plot of chunk unnamed-chunk-7"/></p>

<h2><a name="selecting_multiple"></a>Selecting hierarchies with a column of company IDs</h2>

<p>A customer&#39;s file contains multiple companies of which we might want to calculate, or show (parts) of their hierarchy. The <em>list_selected_hierarchies</em> function can be used to put the graphs of all these companies in a list. In this example we have a data frame <em>tbl_customers</em> with the column <em>id_company</em>, of which we want to retrieve all the graphs. </p>

<pre><code class="r">list_selected_hierarchies &lt;- select_graph_hierarchies(graph_company_hierarchies, 
                                                      tbl_customers$id_company)
</code></pre>

<p>Note that the <em>tbl_customers</em> data-frame contains 300, while the <em>list_selected_hierarchies</em> contains 252 graphs; this is because there are customers that fall within the same company hierarchy. The companies in the graphs in this list now also contain an extra logical attribute, <em>is_searched_company</em>, which indicates whether the company was in the <em>id_company</em> column. Let&#39;s take a look at one of the graphs that contain multiple customers. The customer &#39;vertices&#39; are colored orange here:</p>

<pre><code class="r">igraph::V(graph_example)$color &lt;- ifelse(igraph::V(graph_example)$is_searched_company,
                                                   col_graydon[2],
                                                   col_graydon[4])

plot_graydon_graph(graph_example,
                   vertex.label = &quot;&quot;)
</code></pre>

<p><img src="data:image/png;base64,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4Nu1kbS1vCP8VlDgm7UZtLO8Ifx2TuA7tUMT+E7t0Wwsbwe/yxL4Pu2z7CvvBr9TEvgm7YZsKw/84CdUyQv+AGNXeeDHP6VEVvBHEIGv3zHDpvLAxzxLPiP4o4I95YEPe552PvDH/VrK28Cf0AO+csD/zAX+FF5HeeCjnyyaCfxJuobyHvBn4YAv2mm4fvIW8OfZgC8Z8I85wI9QaydvAD/EDPh6jTHrJt8ffpAY8NUaJdZMvj38MC/gSzWQq5c88BmHEqg5/Egs4Os01qqVPPBZR0uuNfxoqU7ywCceL7PO8OOdGsk3hg9QAr5CwL+qL3wIUh954PMPmlJb+CCiNvJd4aOAgBcvDKiLfFP4OB7gpQP+t3rCR+o0kW8JH2oDvG6xNj3kO8IHywCvWrRMC/mG8OEuwEs2gaWDPPCapwivHfwMFOAFm4LSQL4b/BwS4NWaJVJfHnjp88TVC36eR3l54NXPFFQr+IkawAs1FaO6PPAVThZQI/jJFMXlgS9yutH1gZ8OUVu+Dfx8BuAlAn5fXeAzFErLA1/rnMNqAp9jUFm+B3ySAPDZZQkUlm8Bn7b+wOeWt/515TvAJ64+8IllLj7wiaUufln5+vC5Sw98WslLX1W+PHz2wmef/2jV4fPXPX+CQwFff4JDFYcXWHWBEY4E/OkUZthfbXiJNZcYYnel4UWWXGSMfQF/PpEx9lUZXmbBZQbZEfADkhlkR4XhdZZbZ5Lt1YVXWm2lWTYG/IiUZtlYWXittdaaZkvF4N/fLr1f/0trqbWm2VIp+Cv6pcsfciutNs+vFYL/Uv/qTW1u4MO6Yf+kz57nrmryauv3tDt3OXngY3pwV5MHPiZ5+GryYqv3rBV3NXngIyoAX0xebPGetOquJg/8+ErAX+X/7SyqJ7Z2TyoCf7OzKF+BET+KwEvvLD4kP+BnFeDFdxbvU5/vqwLw6juL94mP9538yzn9Daa7tKf7P+BHpz3dv8QXVv7CfEh6uJuAH5z0cLdJf/NU4JvP+5Rn+5nyyyXgIxPeIAE+NtktUeCjE30TBHjTgHeNl3OmAe+a+AbTY9rT1Ql416R3FlcSH69QyjuLK6nPVyjhncWV5AeslOzO4koFRqyU6M7iSsCbBrxpwJsGvGnAmwa8acCbBrxpwJsGvGnAmwa8acCbBrxpwJsGvGnAmwa8acCbBrxpwJsGvGnAmwa8acCbBrxpwJsGvGnAmwa8acCbBrxpwJsGvGnAmwa8acCbBrxpwJsGvGnAmwa8acCbBrxpwJsGvGnAmwa8acCbBrxpwJsGvGnAmwa8acCbBrxpwJsGvGnAmwa8acCbBrxpwJsGvGnAmwa8acCbBrxpwJsGvGnAmwa8acCbBrxpwJsGvGnAmwa8acCbBrxpwJsGvGnAmwa8acCbBrxpwJsGvGn/AbMHV/yLP+ajAAAAAElFTkSuQmCC" alt="plot of chunk unnamed-chunk-11"/></p>

<h2><a name="selecting_all"></a>Listing all hierarchy graphs</h2>

<p>For whatever reason, you might want to creating a list of all of the seperate company hierarchies out of the complete company hierarchy &#39;space&#39;. This will take some time, so take some coffee&hellip;.    </p>

<pre><code class="r">list_all_graphs &lt;- list_company_hierarchy_graphs(graph_company_hierarchies)
</code></pre>

<h1><a name="convert_graph"></a>Converting company hierarchy graphs to data-frames</h1>

<p>Having graphs is nice for creating beautiful plots and useful calculations, but for the data to be useful for further processing, getting data from the graph into a data-frame format is handy.</p>

<h2><a name="convert_single_graph"></a>Converting a single hierarchy graph</h2>

<p>To turn a graph into a data-frame youy can use the function <em>hierarchy_as_data_frame</em>. We created the graph <em>graph_company_hierarchy</em> by searching hierarchies by company IDs and set the colors to them being in the searched-for companies, this is reflected by the <em>graph_company_hierarchy</em> and <em>color</em> columns respectively.</p>

<pre><code class="r">df_single_hierarchy &lt;- hierarchy_as_data_frame(graph_company_hierarchy)
</code></pre>

<table><thead>
<tr>
<th align="left">name</th>
<th align="right">id_company_parent</th>
<th align="left">code_sbi</th>
<th align="right">size_company</th>
<th align="right">qty_employees</th>
<th align="left">is_searched_company</th>
<th align="left">color</th>
</tr>
</thead><tbody>
<tr>
<td align="left">1003667</td>
<td align="right">931238099</td>
<td align="left">7022</td>
<td align="right">2</td>
<td align="right">15</td>
<td align="left">FALSE</td>
<td align="left">#8BB0DE</td>
</tr>
<tr>
<td align="left">931238099</td>
<td align="right">933898487</td>
<td align="left">6420</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="left">TRUE</td>
<td align="left">#EB6E08</td>
</tr>
<tr>
<td align="left">933898487</td>
<td align="right">911277358</td>
<td align="left">7022</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="left">FALSE</td>
<td align="left">#8BB0DE</td>
</tr>
<tr>
<td align="left">936298138</td>
<td align="right">931238099</td>
<td align="left">7311</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="left">FALSE</td>
<td align="left">#8BB0DE</td>
</tr>
<tr>
<td align="left">911277358</td>
<td align="right">NA</td>
<td align="left">6420</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="left">FALSE</td>
<td align="left">#8BB0DE</td>
</tr>
</tbody></table>

<h2><a name="convert_list_graphs"></a>Converting a list of hierarchy graphs</h2>

<p>A list of graphs can also be converted into a data-frame using <em>hierarchy_list_as_data_frame</em>:</p>

<pre><code class="r">df_selected_hierarchies &lt;- hierarchy_list_as_data_frame(list_selected_hierarchies)
</code></pre>

<h1><a name="calculate"></a>Calculating properties</h1>

<h2><a name="propage_values"></a>Propagating values</h2>

<p>It might come in handy to cumulate values in the hierarchy bottom up; this is where the <em>aggregate_company_hierarchy_value</em> function comes in handy. In this example the companies will get a new attribute <em>qty_employees_cum</em> which will contain the sum of all the <em>qty_employees</em> of the companies that below the company within the hierarchy.</p>

<pre><code class="r">graph_company_hierarchy &lt;- 
  aggregate_hierarchy_value(graph = graph_company_hierarchy, 
                            name_attribute = &quot;qty_employees&quot;,
                            name_aggregate = &quot;qty_employees_cum&quot;,
                            FUN = sum, 
                            na.rm = TRUE)
</code></pre>

<p>The result can be found can be shown in a graph, where we can see the original values and the rolled up values.</p>

<pre><code class="r">igraph::V(graph_company_hierarchy)$label &lt;- paste0(&quot;# &quot;,
                                                   igraph::V(graph_company_hierarchy)$qty_employees,
                                                   &quot; -&gt; Cum # &quot;,
                                                   igraph::V(graph_company_hierarchy)$qty_employees_cum)

plot_graydon_graph(graph_company_hierarchy)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-17"/></p>

<h2><a name="adding_stats"></a>Adding graph statistics</h2>

<p>Some overall statistics about the hierarchy can be added to the individual companies by using the <em>add_company_hierarchy_stats</em> function. This function will add the following attributes</p>

<ul>
<li><em>is_tree</em> - A logical indicating whether the company hierarchy is a tree (which should always be the case).</li>
<li><em>qty_comapny_hierarchy</em> - The the number of companies in the hierarchy.</li>
<li><em>id_company_top</em> - The company ID of the highest company in the hierachy (ultimate mother).</li>
<li><em>distance_to_top</em> - The number of companies between the current company and the ultimate mother company</li>
<li><em>qty_child_companies</em> - The number of child companies.</li>
<li><em>qty_sister_companies</em> - The number of sibling companies.</li>
</ul>

<pre><code class="r">graph_company_hierarchy &lt;- add_company_hierarchy_stats(graph_company_hierarchy)
</code></pre>

<p>Let&#39;s look at the statistics:</p>

<pre><code class="r">df_single_hierarchy &lt;- hierarchy_as_data_frame(graph_company_hierarchy)
</code></pre>

<table><thead>
<tr>
<th align="left">name</th>
<th align="right">id_company_parent</th>
<th align="left">code_sbi</th>
<th align="right">size_company</th>
<th align="right">qty_employees</th>
<th align="left">is_searched_company</th>
<th align="right">qty_employees_cum</th>
<th align="left">is_tree</th>
<th align="right">qty_hierarchy_companies</th>
<th align="left">id_company_top</th>
<th align="right">distance_to_top</th>
<th align="right">qty_child_companies</th>
<th align="right">qty_sister_companies</th>
</tr>
</thead><tbody>
<tr>
<td align="left">1003667</td>
<td align="right">931238099</td>
<td align="left">7022</td>
<td align="right">2</td>
<td align="right">15</td>
<td align="left">FALSE</td>
<td align="right">15</td>
<td align="left">TRUE</td>
<td align="right">5</td>
<td align="left">911277358</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">2</td>
</tr>
<tr>
<td align="left">931238099</td>
<td align="right">933898487</td>
<td align="left">6420</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="left">TRUE</td>
<td align="right">17</td>
<td align="left">TRUE</td>
<td align="right">5</td>
<td align="left">911277358</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">1</td>
</tr>
<tr>
<td align="left">933898487</td>
<td align="right">911277358</td>
<td align="left">7022</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="left">FALSE</td>
<td align="right">17</td>
<td align="left">TRUE</td>
<td align="right">5</td>
<td align="left">911277358</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr>
<td align="left">936298138</td>
<td align="right">931238099</td>
<td align="left">7311</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="left">FALSE</td>
<td align="right">2</td>
<td align="left">TRUE</td>
<td align="right">5</td>
<td align="left">911277358</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">2</td>
</tr>
<tr>
<td align="left">911277358</td>
<td align="right">NA</td>
<td align="left">6420</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="left">FALSE</td>
<td align="right">18</td>
<td align="left">TRUE</td>
<td align="right">5</td>
<td align="left">911277358</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
</tbody></table>

<h2><a name="marking"></a>Marking companies</h2>

<p>You can mark companies within a graphthat meet certain categorical  criteria with the function <em>mark_companies_logical</em>. This can be useful for derivations or coloring graphs. As a somewhat travial  example, let&#39;s mark the companies that have SBI codes (from <em>code_sbi</em>) that are a associated with holdings (that are in the vector <em>vec_sbi_holdings</em>). The new company attribute name will be <em>is_holding</em>.</p>

<pre><code class="r">vec_sbi_holdings &lt;- c(&quot;64&quot;, &quot;642&quot;, &quot;6420&quot;)

graph_company_hierarchy &lt;- mark_companies_logical(graph_company_hierarchy,
                                                  name_logical = &quot;is_holding&quot;,
                                                  name_filter = &quot;code_sbi&quot;,
                                                  set_criteria = vec_sbi_holdings)
</code></pre>

<h2><a name="sister_companies"></a>Sister companies</h2>

<p>You can get the siblings IDs of a company using the function <em>get_sibling_ids</em>, which in turn can be used to mark companies and plot them.</p>

<pre><code class="r">id_siblings &lt;- get_sibling_ids(graph_company_hierarchy, &quot;1003667&quot;)

graph_company_hierarchy &lt;- mark_companies_logical(graph_company_hierarchy,
                                                  name_logical = &quot;is_sibling&quot;, 
                                                  name_filter = &quot;id_company&quot;,
                                                  set_criteria = id_siblings
                                                  )

igraph::V(graph_company_hierarchy)$label &lt;- igraph::V(graph_company_hierarchy)$name
V(graph_company_hierarchy)$color &lt;- ifelse(V(graph_company_hierarchy)$is_sibling,
                                                   col_graydon[2],
                                                   col_graydon[4])

plot_graydon_graph(graph_company_hierarchy)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-22"/></p>

<p>Remember the table of customers? If we want to get all siblings of those companies we can use the function <em>get_siblings_df</em>.</p>

<pre><code class="r">tbl_siblings &lt;- get_siblings_df(graph_company_hierarchies, tbl_customers$id_company)
</code></pre>

<p>Below you can see a sample of the resulting data-frame, where you can see the company with it&#39;s siblings and the <em>qty_siblings</em> indicating the total number of siblings the company of <em>id_company</em> has.</p>

<table><thead>
<tr>
<th align="left">id_company</th>
<th align="left">id_sibling</th>
<th align="right">qty_siblings</th>
</tr>
</thead><tbody>
<tr>
<td align="left">939620014</td>
<td align="left">939601621</td>
<td align="right">4</td>
</tr>
<tr>
<td align="left">939620014</td>
<td align="left">939620073</td>
<td align="right">4</td>
</tr>
<tr>
<td align="left">939620014</td>
<td align="left">939620308</td>
<td align="right">4</td>
</tr>
<tr>
<td align="left">939620014</td>
<td align="left">939620391</td>
<td align="right">4</td>
</tr>
<tr>
<td align="left">745630</td>
<td align="left">922126127</td>
<td align="right">1</td>
</tr>
<tr>
<td align="left">470942</td>
<td align="left">1144496</td>
<td align="right">1</td>
</tr>
</tbody></table>

<h2><a name="recode_holdings"></a>Recoding holdings</h2>

<p>When dealing with customers you&#39;ll ofen encounter them having economic activity codes that mark them as financial holdings. This is often the case because this is the company you send the bills too. But this is not really informative when analysing the type of companies you have as customers. In this case you might want to recode them to better reflect what kind of business they are really in.</p>

<p>Here you see an example of a company hierarchy with some holdings, which are colored orange here:</p>

<pre><code class="r">vec_sbi_holdings &lt;- c(&quot;64&quot;, &quot;642&quot;, &quot;6420&quot;)

graph_company_hierarchy &lt;- mark_companies_logical(graph_company_hierarchy,
                                                  name_logical = &quot;is_holding&quot;,
                                                  name_filter = &quot;code_sbi&quot;,
                                                  set_criteria = vec_sbi_holdings)

igraph::V(graph_company_hierarchy)$label &lt;- igraph::V(graph_company_hierarchy)$code_sbi
V(graph_company_hierarchy)$color &lt;- ifelse(V(graph_company_hierarchy)$is_holding,
                                                   col_graydon[2],
                                                   col_graydon[4])

plot_graydon_graph(graph_company_hierarchy)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-25"/></p>

<pre><code class="r">vec_sbi_holdings &lt;- c(&quot;64&quot;, &quot;642&quot;, &quot;6420&quot;)
library(&quot;png&quot;)

img_holding &lt;- readPNG(&quot;~/R scripts/hierarchy_changes/money-svg-hand-icon-png-3.png&quot;)
img_regular &lt;- readPNG(&quot;~/R scripts/hierarchy_changes/vector-apartments-business-building-6.png&quot;)

graph_company_hierarchy &lt;- mark_companies_logical(graph_company_hierarchy,
                                                  name_logical = &quot;is_holding&quot;,
                                                  name_filter = &quot;code_sbi&quot;,
                                                  set_criteria = vec_sbi_holdings)

V(graph_company_hierarchy)$raster &lt;- list(img_regular, img_holding)[V(graph_company_hierarchy)$is_holding+1]

plot_graydon_graph(graph_company_hierarchy, 
                   vertex.shape=&quot;raster&quot;, 
                   vertex.label=NA,
                   vertex.size=24, 
                   vertex.size2=24, 
                   edge.width=2)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAJ1BMVEUAAAABAQECAgIEBAQPDw8zMzNPT09WVlacnJy6v8Hl5eX+/v7///8Mh44tAAAACXBIWXMAAAsSAAALEgHS3X78AAAIrklEQVR4nO3di1KbUBRA0fTdpPz/93aMQl4Eifd57t57nKnWjsBZcEOjbQ6TITu03gFrk/DQhIcmPDThoQkPTXhowkMTHprw0ISHJjw04aEJD014aMJDEx6a8NCEhyY8NOGhCQ9NeGjCQxMemvDQhIcmPDThoQkPTXhowkMTHprw0ISHJjw04aEJD014aMJDEx6a8NCEhyY8NOGhCQ9NeGjCQxMemvDQhIcmPDThoQkPTXhowkMTHprw0ISHJjw04aEJD014aMJDEx6a8NCEhyY8NOGhCQ9NeGjCQxMemvDQhN/ocFPrvcnbYIeTt2ts4UEJT+xueR9ttR/pWPL2yCw8IuGhnZkPV2/CM/KKhyY8tDPz6eptGurpnPAHUKztx/jwcwt/AMUSHtrqY/zNiRC68AdQrO2bu/BzC38AxXKph7YK71I/fl7x0HyMh+ZSD82lHprw0HwCB5o3d9C8uYMmPDRv7qB5cwdtvuJP8zvCM1qFv3y20V5lK/wBFMsrHprw0OaF/bSs8C71iA7btd691MIfQLGEtxETfl/HY+s9yJzwOxtNXvidCQ9NeGjCQxMemvDQhIcmPDThoQkPTXhowkMTHprw0ISHJjw04aEJD014aMJDEx6a8NCEhyY8NOGhCQ9NeGjCQxOe2mDywu9NeGjCQxMemvDQhIcmPDThoQkPTXhowkMTHprw0ISHJjw04aEJD014aMJDEx6a8NCEhyY8NOGhCQ9NeGjCQxMemvDUxpIXfnfCQxMemvDQhIcmPDThoQkPTXhowkMTHprw0ISHJjw04aEJD014aMJDEx6a8NCEhyY8s+NbrXciX8LvbSx34fcnPLSh3IXfn/DQhIcmPLQP+H+NdyNTwr/S4aPW+5GhEY6hWgfhkS3iIwxthGOo1BhX+txIx1K2sdyF353w0MZyF35vg13wwu/rcFPrvcnREAdRo0G8l8Y6moIJj8ylHprw2AbxXhrraEomPLTKl3zpBxfh91Ydfv39bF8//5cctbrywvfTvOb+vB9a9p/Gu1veS6z2wr/Q40PucS73hj7/ndRNZP56Y/fn/lbreF+e7Qgfogf95DPgzHy4ehO+yy7MmU4Ar/iwpZ0AwofvayfAmfl09TZlfzpH+M/7nmHir50A24/xwpdttr598jRxYPtuAoRv2RP4PEvt9gmw+hh/cyIkJ/zTnsNfXNLHt3oCbN/cCV+2Ffhp+nv+9dfyB7Jt7RHepb5Ra1f8j7vPFhrfKrxLfaW2lvqPvhXb9OQV36zP4Qtueut3hC/bp/AlNz251DfrAn/98dLvopueXOqbtXJZV7ncJ+Fb1vT/uPIJnGalfkc9LW/uWtXW3Zu7VjV2F75Rrd29uWtTc3dv7prU3n254k/zO8KXrwP3dfjLZ7NsIscXGake3L3i69eFu/DV68N9WdhPywrvUl+0Tty3fgQg1/cJhL+qF3fh69aNe42EX0K5Cz/35X/gGDTh36O5C/8ejV3493juwr8FdBd+YroLD3UXHuouPNQdD091p8Nj3eHwXHc2PNgdDU92J8Oj3cHwbHcuPNwdC093p8Lj3aHwujPhdWfC6z4h4XV/iwev+zkcvO7v0eB1/wgGr/scC173JRS87pdI8LpfBYLX/ToMPO6fw34SBV73uyDwst/HgNf9IQS87o8R4HVfCQCv+1rjw+u+2vDwuq83NPxR96eNDe/TNk8bHr71PvTayPBHr/jnDQ7fehf6bWB43bcaF173zUaGb70HXRcYPv/LdZAKPLCbF2YKfBxtCjww4VOKOrC75d3V/tWiTmv19ZZtf1GnJXxiUac1v+jq5dVWhX+pqNPyik8s6rSETyzqtM7Mp6u3yadzXirqiLYf46MeVcWijkj4xKKOaPUx/uZEsM2ijmj75i7qUVUs6ohc6hOLOqJVeJf6/UUdkVd8YlFH5GN8YlFH5FKfWNQRudQnFnVEwicWdUQ+gZNY1BF5c5dY1BF5c5dY1BEJn1jUEXlzl1jUEXlzl1jUEc1X/Gl+R/jXijqiVfjLZxvtVaCijsgrPrGoIxI+sagjmhf207LCu9S/VNQRHbZrvXv9F3VEwifmiKAFhPc/t8lRPHj/N6sshYPXPU/R4HXPVDB43XMVC173bIWC1z1fkeB1z1ggeN1zFgde96yFgdc9b1Hgdc9cEHjdcxcDXvfshYDXPX8R4HUvUAB43UvUP7zuReoeXvcy9Q6ve6E6h9e9VH3D616sruF1L1fH8L4GeMn6hde9aN3Cy162XuF1L1yn8LqXrk943YvXJbzu5esRXvcKdQive436g9e9St3B616n3uB1r1Rn8LrXqi943avVFbzu9eoJXveKdQSve806gT/qXrle4P2xi8p1BN96H1j1A996F2D1Ae9KX70u4FWvXw/wujeoDfy/m490b1B9eF9Eoouqz99XD+mj2vNfxIVvW+X5e6X3Ul0H3btJeGi14atuzp5XVcILvp8qSvhakD3lFQ9NeGgu9dCEh+ZSD82/x0PzmTtowkPzu3PQGnw//rzJn54AbfMncKDVn/8f3XtIAGjCQxMemvDQasF/926+rwo7zNa335kTv31t4LVvXjP4C73nQIvqw0/T3/Ovv5Y/UHYXbLUGV/yPu88K36KGS/1H38ruga3XHL7s9u1ZreHLbt6eVg3++uOl32W3bs+rBP/wW17ujXP40ISHJjw04aEJD014aMJDEx6a8NCEhyY8NOGhCQ9NeGjCQxMemvDQhIcmPDThoQkPTXhowkMTHprw0ISHJjw04aEJD014aMJDEx6a8NCEhyY8NOGhCQ9NeGjCQxMemvDQhIcmPDThoQkPTXhowkMTHprw0ISHJjw04aEJD014aMJDEx6a8NCEhyY8NOGhCQ9NeGjCQxMemvDQhIcmPDThoQkPTXhowkMTHprw0ISHJjw04aEJD014aMJDEx6a8NCEhyY8NOGhCQ9NeGjCQ/sPYZQpcZOhlBUAAAAASUVORK5CYII=" alt="plot of chunk unnamed-chunk-26"/></p>

<p>You can count the number of financial holdings in a company hierarchy like this:</p>

<pre><code class="r">count_companies_by_set(graph = graph_company_hierarchy,
                       name_filter = &quot;code_sbi&quot;,
                       set_criteria = vec_sbi_holdings)
#&gt; [1] 2
</code></pre>

<p>You can use the function <em>recode_holding_codes</em> to recode the holdings so they reflect the economic activity codes of the majority of the children:</p>

<pre><code class="r">graph_company_hierarchy &lt;- recode_holding_codes(graph_company_hierarchy, 
                                                name_activity_code = &quot;code_sbi&quot;, 
                                                vec_holding_codes = c(&quot;64&quot;, &quot;642&quot;, &quot;6420&quot;))
</code></pre>

<p>This would result in this recoded company hierarchy:
<img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-29"/></p>

</body>

</html>
